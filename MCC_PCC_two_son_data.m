clc;clear all
x=[191	155	179	145
195	149	201	152
181	148	185	149
183	153	188	149
176	144	171	142
208	157	192	152
189	150	190	149
197	159	189	152
188	152	197	159
192	150	187	151
179	158	176	148
183	147	174	147
174	150	185	152
190	159	195	157
188	151	187	158
163	137	161	130
195	155	183	158
186	153	173	148
181	145	182	148
175	140	165	137
192	154	185	152
174	143	178	147
176	139	176	143
197	167	200	158
190	163	187	150
195	159	168	139]';
[p n]=size(x);
s=cov(x')*(n-1)/n;  % MLE of S
%----------Calculation and output-------
sr1_234=sqrt(1-(det(s)/(s(1,1)*det(s(2:p,2:p)))));     
fprintf('\n\t  Sample MCC r1.234=%f \n',sr1_234);
% %----------PCC Calculation and output-------
q=2;
s11=s(1:q,1:q);         s12=s(1:q,q+1:p);
s21=s12';               s22=s(q+1:p,q+1:p);
s11_2=s11-s12*inv(s22)*s21;
sr12_34=s11_2(1,2)/sqrt(s11_2(1,1)*s11_2(2,2));
fprintf('\n\t  Sample Partial corr. coeff r12.34=%f \n',sr12_34);
